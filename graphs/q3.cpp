//topological sort(couldn't understand)